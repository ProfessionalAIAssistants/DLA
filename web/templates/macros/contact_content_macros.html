{# Contact Content Macros - For main content area components #}

{# Contact Information Card Macro #}
{% macro contact_info_card(contact) %}
<div class="card mb-4">
    <div class="card-header">
        <h5 class="card-title mb-0">
            <i class="fas fa-info-circle me-2"></i>Contact Information
        </h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <table class="table table-borderless">
                    <tr>
                        <td><strong>Name:</strong></td>
                        <td>{{ contact.first_name }} {{ contact.last_name }}</td>
                    </tr>
                    <tr>
                        <td><strong>Email:</strong></td>
                        <td>
                            {% if contact.email %}
                            <a href="mailto:{{ contact.email }}">{{ contact.email }}</a>
                            {% else %}
                            N/A
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Phone:</strong></td>
                        <td>
                            {% if contact.phone %}
                            <a href="tel:{{ contact.phone }}">{{ contact.phone }}</a>
                            {% else %}
                            N/A
                            {% endif %}
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Title:</strong></td>
                        <td>{{ contact.title or 'N/A' }}</td>
                    </tr>
                    {% if contact.buyer_code %}
                    <tr>
                        <td><strong>Buyer Code:</strong></td>
                        <td><span class="badge bg-primary">{{ contact.buyer_code }}</span></td>
                    </tr>
                    {% endif %}
                </table>
            </div>
            <div class="col-md-6">
                <table class="table table-borderless">
                    <tr>
                        <td><strong>Fax:</strong></td>
                        <td>{{ contact.fax or 'N/A' }}</td>
                    </tr>
                    <tr>
                        <td><strong>Created:</strong></td>
                        <td>{{ contact.created_date or 'N/A' }}</td>
                    </tr>
                    <tr>
                        <td><strong>Modified:</strong></td>
                        <td>{{ contact.modified_date or 'N/A' }}</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>
{% endmacro %}

{# Recent Interactions Card Macro #}
{% macro recent_interactions_card(interactions) %}
<div class="card mb-4">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="card-title mb-0">
            <i class="fas fa-comments me-2"></i>Recent Interactions
        </h5>
        <span class="badge bg-primary">{{ interactions|length }}</span>
    </div>
    <div class="card-body">
        {% if interactions %}
        <div class="mb-2">
            <small class="text-muted">Double-click any interaction to view details</small>
        </div>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Type</th>
                        <th>Subject</th>
                        <th>Duration</th>
                        <th>Outcome</th>
                    </tr>
                </thead>
                <tbody>
                    {% for interaction in interactions[:5] %}
                    <tr class="interaction-row" data-interaction-id="{{ interaction.id }}" style="cursor: pointer;" title="Double-click to view interaction details">
                        <td>{{ interaction.interaction_date or 'N/A' }}</td>
                        <td>
                            <span class="badge bg-info">{{ interaction.type or 'N/A' }}</span>
                        </td>
                        <td>{{ interaction.subject or 'N/A' }}</td>
                        <td>{{ interaction.duration_minutes or 'N/A' }} min</td>
                        <td>{{ interaction.outcome or 'N/A' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="text-center py-4">
            <i class="fas fa-comments fa-3x text-muted mb-3"></i>
            <p class="text-muted">No interactions recorded for this contact yet.</p>
            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addInteractionModal">
                <i class="fas fa-plus me-1"></i>
                Add First Interaction
            </button>
        </div>
        {% endif %}
    </div>
</div>
{% endmacro %}

{# Related Opportunities Card Macro #}
{% macro related_opportunities_card(opportunities) %}
<div class="card mb-4">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="card-title mb-0">
            <i class="fas fa-handshake me-2"></i>Related Opportunities
        </h5>
        <span class="badge bg-warning">{{ opportunities|length }}</span>
    </div>
    <div class="card-body">
        {% if opportunities %}
        <div class="mb-2">
            <small class="text-muted">Double-click any opportunity to view details</small>
        </div>
        <div class="table-responsive">
            <table class="table table-sm table-hover">
                <thead class="table-light">
                    <tr>
                        <th><i class="fas fa-handshake me-1"></i>Opportunity</th>
                        <th><i class="fas fa-chart-line me-1"></i>Stage</th>
                        <th><i class="fas fa-dollar-sign me-1"></i>Amount</th>
                        <th><i class="fas fa-calendar me-1"></i>Close Date</th>
                        <th class="text-center"><i class="fas fa-cogs me-1"></i>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for opportunity in opportunities %}
                    <tr class="opportunity-row" data-opportunity-id="{{ opportunity.id }}" style="cursor: pointer;" ondblclick="viewOpportunity({{ opportunity.id }})">
                        <td>
                            <div>
                                <strong>{{ opportunity.name or 'Unnamed Opportunity' }}</strong>
                                {% if opportunity.product_nsn %}
                                    <br><small class="text-muted"><i class="fas fa-barcode me-1"></i>{{ opportunity.product_nsn }}</small>
                                {% endif %}
                            </div>
                        </td>
                        <td>
                            <span class="badge bg-{{ 'success' if opportunity.stage == 'Closed Won' else 'danger' if opportunity.stage == 'Closed Lost' else 'secondary' if opportunity.stage in ['Prospecting', 'Qualification'] else 'primary' }}">{{ opportunity.stage or 'N/A' }}</span>
                        </td>
                        <td>
                            {% if opportunity.amount %}
                                <strong>${{ "{:,.2f}".format(opportunity.amount) }}</strong>
                            {% else %}
                                <span class="text-muted">N/A</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if opportunity.close_date %}
                            <small>{{ opportunity.close_date | date }}</small>
                            {% else %}
                            <span class="text-muted">Not set</span>
                            {% endif %}
                        </td>
                        <td class="text-center">
                            <div class="btn-group btn-group-sm">
                                <button type="button" class="btn btn-outline-primary" onclick="viewOpportunity({{ opportunity.id }})" title="View Details">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button type="button" class="btn btn-outline-secondary" onclick="editOpportunity({{ opportunity.id }})" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="text-center py-4">
            <i class="fas fa-handshake fa-3x text-muted mb-3"></i>
            <p class="text-muted">No opportunities associated with this contact yet.</p>
            <button class="btn btn-warning">
                <i class="fas fa-plus me-1"></i>
                Create Opportunity
            </button>
        </div>
        {% endif %}
    </div>
</div>
{% endmacro %}

{# Contact Header Macro #}
{% macro contact_header(contact) %}
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h2">
        <i class="fas fa-user me-2"></i>{{ contact.first_name }} {{ contact.last_name }}
        {% if contact.title %}
        <span class="badge bg-secondary ms-2">{{ contact.title }}</span>
        {% endif %}
    </h1>
    <div class="btn-toolbar mb-2 mb-md-0">
        <div class="btn-group me-2">
            <button type="button" class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#editContactModal">
                <i class="fas fa-edit me-1"></i>
                Edit Contact
            </button>
            <button type="button" class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#addInteractionModal">
                <i class="fas fa-plus me-1"></i>
                Add Interaction
            </button>
        </div>
        <a href="{{ url_for('contacts') }}" class="btn btn-sm btn-outline-secondary">
            <i class="fas fa-arrow-left me-1"></i>
            Back to Contacts
        </a>
    </div>
</div>
{% endmacro %}