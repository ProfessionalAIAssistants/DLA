{% extends "base.html" %}
{% from 'macros/task_macros.html' import task_header, quick_actions_card, task_details_card, task_info_edit, task_info_view, related_opportunities_table, processing_data_report, processing_report_card %}

{% block title %}{{ task.subject if task.subject else 'Task Details' }} - CDE Prosperity{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12">
            <!-- Header -->
            {{ task_header(task, edit_mode) }}

            <!-- Main Content Row -->
            <div class="row">
                <!-- Right Panel -->
                <div class="col-lg-4 order-lg-2 mb-4">
                    <!-- Quick Actions -->
                    {{ quick_actions_card(task) }}

                    <!-- Task Details -->
                    {{ task_details_card(task) }}
                </div>

                <!-- Left Panel (Main Content) -->
                <div class="col-lg-8 order-lg-1">
                    <!-- Task Information -->
                    {% if edit_mode %}
                        {{ task_info_edit(task) }}
                    {% else %}
                        {{ task_info_view(task) }}
                    {% endif %}

                    <!-- Related Opportunities (for processing tasks) -->
                    {% if opportunities %}
                        {{ related_opportunities_table(opportunities) }}
                    {% endif %}

                    <!-- Processing Report (for PDF processing tasks) -->
                    {% if processing_data %}
                        {{ processing_data_report(processing_data) }}
                    {% endif %}

                    <!-- Processing Report (for processing tasks) -->
                    {% if processing_report %}
                        {{ processing_report_card(processing_report) }}
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Include task scripts -->
{% include 'scripts/task_scripts.html' %}
{% endblock %}